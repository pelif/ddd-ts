{"version":3,"sources":["../../../../../src/infrastructure/product/repository/sequelize/product.repository.spec.ts"],"sourcesContent":["import { Sequelize } from \"sequelize-typescript\";\nimport ProductModel from \"./product.model\";\nimport Product from \"../../../../domain/product/entity/product\";\nimport ProductRepository from \"./product.repository\";\n\ndescribe(\"Product Repository Test\", () => {\n\n    let sequelize: Sequelize; \n\n    beforeEach(async() => {\n        sequelize = new Sequelize({\n            dialect: 'sqlite', \n            storage: ':memory:', \n            logging: false, \n            sync: { force: true }, \n        });\n\n        sequelize.addModels([ProductModel]); \n        await sequelize.sync();\n    }); \n\n    afterEach(async() => {\n        await sequelize.close();\n    }); \n\n    it(\"should create a product\", async() => {\n        const productRepository = new ProductRepository(); \n        const product = new Product('p1', \"product 01\", 100); \n\n        await productRepository.create(product); \n\n        const productModel = await ProductModel.findOne({ where: {id: \"p1\"}}); \n\n        expect(productModel.toJSON()).toStrictEqual({\n            id: \"p1\", \n            name: \"product 01\", \n            price: 100\n        }); \n    }); \n\n    it(\"should update a product\", async() => {\n        const productRepository = new ProductRepository(); \n        const product = new Product('p1', \"product 01\", 100); \n\n        await productRepository.create(product); \n\n        const productModel = await ProductModel.findOne({ where: {id: \"p1\"}}); \n\n        expect(productModel.toJSON()).toStrictEqual({\n            id: \"p1\", \n            name: \"product 01\", \n            price: 100\n        }); \n\n        product.changeName(\"Product 02\"); \n        product.changePrice(200); \n\n        await productRepository.update(product); \n\n        const productModel2 = await ProductModel.findOne({ where: { id: \"p1\"}}); \n\n        expect(productModel2.toJSON()).toStrictEqual({\n            id: \"p1\", \n            name: \"Product 02\", \n            price: 200\n        }); \n\n    }); \n\n    it(\"should find a product\", async() => {\n        const productRepository = new ProductRepository(); \n        const product = new Product(\"p1\", \"Product 01\", 100); \n\n        await productRepository.create(product); \n\n        const productModel = await ProductModel.findOne({ where: { id: \"p1\"}}); \n        const foundProduct = await productRepository.find(\"p1\"); \n\n        expect(productModel.toJSON()).toStrictEqual({\n            id: foundProduct.id, \n            name: foundProduct.name, \n            price: foundProduct.price\n        }); \n    }); \n\n    it(\"should find all product\", async() => {\n        const productRepository = new ProductRepository();\n        const product = new Product(\"p1\", \"Product 01\", 150); \n        await productRepository.create(product); \n\n        const product2 = new Product(\"p2\", \"Product 02\", 180); \n        await productRepository.create(product2); \n\n        const foundProducts = await productRepository.findAll();\n        const products = [product, product2]; \n\n        expect(products).toEqual(foundProducts); \n\n    }); \n\n}); "],"names":["Sequelize","ProductModel","Product","ProductRepository","describe","sequelize","beforeEach","dialect","storage","logging","sync","force","addModels","afterEach","close","it","productRepository","product","productModel","create","findOne","where","id","expect","toJSON","toStrictEqual","name","price","productModel2","changeName","changePrice","update","foundProduct","find","product2","foundProducts","products","findAll","toEqual"],"mappings":"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"}