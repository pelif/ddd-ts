{"version":3,"sources":["../../../../../src/domain/usecase/customer/find/find.customer.unit.spec.ts"],"sourcesContent":["import { Sequelize } from \"sequelize-typescript\";\nimport CustomerModel from \"../../../../infrastructure/customer/repository/sequelize/customer.model\";\nimport CustomerRepository from \"../../../../infrastructure/customer/repository/sequelize/customer.repository\";\nimport Customer from \"../../../customer/entity/customer\";\nimport Address from \"../../../customer/value-object/address\";\nimport FindCustomerUseCase from \"./find.customer.usecase\";\n\nconst customer = new Customer(\"123\", \"Customer 1\");\nconst address = new Address(\"Street 1\", 9781, \"Zipcode1\", \"City 1\");\ncustomer.changeAddress(address);\n\nconst MockRepository = () => {\n    return {\n        find: jest.fn().mockReturnValue(Promise.resolve(customer)),\n        findAll: jest.fn(),\n        create: jest.fn(),\n        update: jest.fn(),\n        delete: jest.fn()\n    }\n}\n\ndescribe(\"Test find customer use case\", () => {\n\n    let sequelize: Sequelize;\n\n    beforeEach(async () => {\n        sequelize = new Sequelize({\n            dialect: 'sqlite',\n            storage: ':memory:',\n            logging: false,\n            sync: { force: true },\n        });\n\n        sequelize.addModels([CustomerModel]);\n        await sequelize.sync();\n    });\n\n    afterEach(async () => {\n        await sequelize.close();\n    });\n\n    it(\"should find a customer\", async () => {\n\n        const customerRepository = MockRepository();\n        const usecase = new FindCustomerUseCase(customerRepository);\n\n        const input = {\n            id: \"123\"\n        }\n\n        const output = {\n            id: \"123\",\n            name: \"Customer 1\",\n            address: {\n                street: \"Street 1\",\n                number: 9781,\n                zip: \"Zipcode1\",\n                city: \"City 1\"\n            }\n        }\n\n        const result = await usecase.execute(input);\n\n        expect(result).toEqual(output);\n\n    });\n\n    it(\"should throw an error when customer is not found\", async () => {\n\n        const customerRepository = MockRepository();\n        customerRepository.find.mockImplementationOnce(() => {\n            throw new Error(\"Customer not found\");\n        });\n        const usecase = new FindCustomerUseCase(customerRepository);\n\n        const input = {\n            id: \"123\"\n        }\n\n        await expect(usecase.execute(input)).rejects.toThrow(\"Customer not found\");\n    });\n\n\n}); "],"names":["Sequelize","CustomerModel","Customer","Address","FindCustomerUseCase","customer","address","changeAddress","MockRepository","find","jest","fn","mockReturnValue","Promise","resolve","findAll","create","update","delete","describe","sequelize","beforeEach","dialect","storage","logging","sync","force","addModels","afterEach","close","it","customerRepository","usecase","input","output","result","id","name","street","number","zip","city","execute","expect","toEqual","mockImplementationOnce","Error","rejects","toThrow"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,SAASA,SAAS,QAAQ,uBAAuB;AACjD,OAAOC,mBAAmB,0EAA0E;AAEpG,OAAOC,cAAc,oCAAoC;AACzD,OAAOC,aAAa,yCAAyC;AAC7D,OAAOC,yBAAyB,0BAA0B;AAE1D,IAAMC,WAAW,IAAIH,SAAS,OAAO;AACrC,IAAMI,UAAU,IAAIH,QAAQ,YAAY,MAAM,YAAY;AAC1DE,SAASE,aAAa,CAACD;AAEvB,IAAME,iBAAiB;IACnB,OAAO;QACHC,MAAMC,KAAKC,EAAE,GAAGC,eAAe,CAACC,QAAQC,OAAO,CAACT;QAChDU,SAASL,KAAKC,EAAE;QAChBK,QAAQN,KAAKC,EAAE;QACfM,QAAQP,KAAKC,EAAE;QACfO,QAAQR,KAAKC,EAAE;IACnB;AACJ;AAEAQ,SAAS,+BAA+B;IAEpC,IAAIC;IAEJC,WAAW;;;;;wBACPD,YAAY,IAAIpB,UAAU;4BACtBsB,SAAS;4BACTC,SAAS;4BACTC,SAAS;4BACTC,MAAM;gCAAEC,OAAO;4BAAK;wBACxB;wBAEAN,UAAUO,SAAS;4BAAE1B;;wBACrB;;4BAAMmB,UAAUK,IAAI;;;wBAApB;;;;;;QACJ;;IAEAG,UAAU;;;;;wBACN;;4BAAMR,UAAUS,KAAK;;;wBAArB;;;;;;QACJ;;IAEAC,GAAG,0BAA0B;;gBAEnBC,oBACAC,SAEAC,OAIAC,QAWAC;;;;wBAlBAJ,qBAAqBvB;wBACrBwB,UAAU,IAAI5B,oBAAoB2B;wBAElCE,QAAQ;4BACVG,IAAI;wBACR;wBAEMF,SAAS;4BACXE,IAAI;4BACJC,MAAM;4BACN/B,SAAS;gCACLgC,QAAQ;gCACRC,QAAQ;gCACRC,KAAK;gCACLC,MAAM;4BACV;wBACJ;wBAEe;;4BAAMT,QAAQU,OAAO,CAACT;;;wBAA/BE,SAAS;wBAEfQ,OAAOR,QAAQS,OAAO,CAACV;;;;;;QAE3B;;IAEAJ,GAAG,oDAAoD;;gBAE7CC,oBAIAC,SAEAC;;;;wBANAF,qBAAqBvB;wBAC3BuB,mBAAmBtB,IAAI,CAACoC,sBAAsB,CAAC;4BAC3C,MAAM,IAAIC,MAAM;wBACpB;wBACMd,UAAU,IAAI5B,oBAAoB2B;wBAElCE,QAAQ;4BACVG,IAAI;wBACR;wBAEA;;4BAAMO,OAAOX,QAAQU,OAAO,CAACT,QAAQc,OAAO,CAACC,OAAO,CAAC;;;wBAArD;;;;;;QACJ;;AAGJ"}