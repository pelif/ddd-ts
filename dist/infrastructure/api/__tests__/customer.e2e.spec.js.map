{"version":3,"sources":["../../../../src/infrastructure/api/__tests__/customer.e2e.spec.ts"],"sourcesContent":["import { app, sequelize } from '../express';\nimport request from 'supertest';\n\ndescribe(\"E2E test for Customer\", () => {\n\n    beforeEach(async () => {\n        await sequelize.sync({ force: true });\n    });\n\n    afterAll(async () => {\n        await sequelize.close();\n    });\n\n    it(\"Should create a customer\", async () => {\n        const response = await request(app)\n            .post('/customer')\n            .send({\n                name: \"Customer 1\",\n                address: {\n                    street: \"Street 1\",\n                    number: 1,\n                    zip: \"12345678\",\n                    city: \"City 1\",\n                }\n            });\n\n        expect(response.status).toBe(200);\n        expect(response.body.name).toBe(\"Customer 1\");\n        expect(response.body.address.street).toBe(\"Street 1\");\n        expect(response.body.address.number).toBe(1);\n        expect(response.body.address.city).toBe(\"City 1\");\n        expect(response.body.address.zip).toBe(\"12345678\");\n    });\n\n    it(\"Should not create a customer with invalid name\", async () => {\n        const response = await request(app)\n            .post('/customer')\n            .send({\n                name: \"\",\n                address: {\n                    street: \"Street 1\",\n                    number: 1,\n                    zip: \"12345678\",\n                    city: \"City 1\",\n                }\n            });\n\n        expect(response.status).toBe(500);\n    });\n\n    it(\"Should  list all customers\", async () => {\n        const response = await request(app)\n            .post('/customer')\n            .send({\n                name: \"Customer 1\",\n                address: {\n                    street: \"Street 1\",\n                    number: 1,\n                    zip: \"12345678\",\n                    city: \"City 1\",\n                }\n            });\n\n        expect(response.status).toBe(200);\n\n        const response2 = await request(app)\n            .post('/customer')\n            .send({\n                name: \"Customer 2\",\n                address: {\n                    street: \"Street 2\",\n                    number: 2,\n                    zip: \"12345678\",\n                    city: \"City 2\",\n                }\n            });\n\n        expect(response2.status).toBe(200);\n\n        const listResponse = await request(app)\n            .get('/customer')\n            .send();\n\n        expect(listResponse.status).toBe(200);\n        expect(listResponse.body.customers.length).toBe(2);\n\n        const customer = listResponse.body.customers[0];\n        expect(customer.id).toBe(response.body.id);\n        expect(customer.name).toBe(\"Customer 1\");\n        expect(customer.address.street).toBe(\"Street 1\");\n        expect(customer.address.number).toBe(1);\n        expect(customer.address.city).toBe(\"City 1\");\n        expect(customer.address.zip).toBe(\"12345678\");\n\n        const customer2 = listResponse.body.customers[1];\n        expect(customer2.id).toBe(response2.body.id);\n        expect(customer2.name).toBe(\"Customer 2\");\n        expect(customer2.address.street).toBe(\"Street 2\");\n        expect(customer2.address.number).toBe(2);\n        expect(customer2.address.city).toBe(\"City 2\");\n        expect(customer2.address.zip).toBe(\"12345678\");\n    });\n}); "],"names":["app","sequelize","request","describe","beforeEach","sync","force","afterAll","close","it","response","post","send","name","address","street","number","zip","city","expect","status","toBe","body","response2","listResponse","customer","customer2","get","customers","length","id"],"mappings":"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"}