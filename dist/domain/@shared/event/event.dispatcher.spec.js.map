{"version":3,"sources":["../../../../src/domain/@shared/event/event.dispatcher.spec.ts"],"sourcesContent":["\nimport SendEmailWhenProductIsCreatedHandler from \"../../product/event/handler/send-email-when-product-is-created.handler\";\nimport ProductCreatedEvent from \"../../product/event/product-created.event\";\nimport EventDispatcher from \"./event-dispatcher\";\n\ndescribe(\"Domain Event Dispatcher unit tests\", () => {\n    \n    it(\"should register an event handler\", () => {\n        const eventDispatcher = new EventDispatcher();\n        const eventHandler = new SendEmailWhenProductIsCreatedHandler();\n        \n        eventDispatcher.register(\"ProductCreatedEvent\", eventHandler);\n\n        expect(eventDispatcher.getEventHandlers[\"ProductCreatedEvent\"]).toBeDefined();\n        expect(eventDispatcher.getEventHandlers[\"ProductCreatedEvent\"].length).toBe(1);\n        expect(eventDispatcher.getEventHandlers[\"ProductCreatedEvent\"][0]).toMatchObject(eventHandler);\n    });\n\n    it(\"should unregister an event handler\", () => {\n        const eventDispatcher = new EventDispatcher();\n        const eventHandler = new SendEmailWhenProductIsCreatedHandler();\n        \n        eventDispatcher.register(\"ProductCreatedEvent\", eventHandler);\n        expect(eventDispatcher.getEventHandlers[\"ProductCreatedEvent\"][0]).toMatchObject(eventHandler);\n\n        eventDispatcher.unregister(\"ProductCreatedEvent\", eventHandler);\n\n        expect(eventDispatcher.getEventHandlers[\"ProductCreatedEvent\"].length).toBe(0);\n        expect(eventDispatcher.getEventHandlers[\"ProductCreatedEvent\"]).toBeDefined();\n    });\n\n    it(\"should unregister all event handlers\", () => {\n        const eventDispatcher = new EventDispatcher();\n        const eventHandler = new SendEmailWhenProductIsCreatedHandler();\n        \n        eventDispatcher.register(\"ProductCreatedEvent\", eventHandler);\n        expect(eventDispatcher.getEventHandlers[\"ProductCreatedEvent\"][0]).toMatchObject(eventHandler);\n\n        eventDispatcher.unregisterAll();\n\n        expect(eventDispatcher.getEventHandlers[\"ProductCreatedEvent\"]).toBeUndefined();\n        \n\n    }); \n\n    it(\"should notify an event\", () => {\n        const eventDispatcher = new EventDispatcher();\n        const eventHandler = new SendEmailWhenProductIsCreatedHandler();\n        const spyEventHandler = jest.spyOn(eventHandler, \"handle\");\n\n        eventDispatcher.register(\"ProductCreatedEvent\", eventHandler);     \n\n        expect(eventDispatcher.getEventHandlers[\"ProductCreatedEvent\"][0]).toMatchObject(eventHandler);\n       \n        const productCreatedEvent = new ProductCreatedEvent({\n            id: \"1\",\n            name: \"Product 1\",\n            description: \"Product 1 description\",\n            price: 10\n        });\n\n        eventDispatcher.notify(productCreatedEvent);\n\n        expect(spyEventHandler).toHaveBeenCalled();\n\n    });\n\n}); "],"names":["SendEmailWhenProductIsCreatedHandler","ProductCreatedEvent","EventDispatcher","describe","it","eventDispatcher","eventHandler","register","expect","getEventHandlers","toBeDefined","length","toBe","toMatchObject","unregister","unregisterAll","toBeUndefined","spyEventHandler","jest","spyOn","productCreatedEvent","id","name","description","price","notify","toHaveBeenCalled"],"mappings":"AACA,OAAOA,0CAA0C,yEAAyE;AAC1H,OAAOC,yBAAyB,4CAA4C;AAC5E,OAAOC,qBAAqB,qBAAqB;AAEjDC,SAAS,sCAAsC;IAE3CC,GAAG,oCAAoC;QACnC,IAAMC,kBAAkB,IAAIH;QAC5B,IAAMI,eAAe,IAAIN;QAEzBK,gBAAgBE,QAAQ,CAAC,uBAAuBD;QAEhDE,OAAOH,gBAAgBI,gBAAgB,CAAC,sBAAsB,EAAEC,WAAW;QAC3EF,OAAOH,gBAAgBI,gBAAgB,CAAC,sBAAsB,CAACE,MAAM,EAAEC,IAAI,CAAC;QAC5EJ,OAAOH,gBAAgBI,gBAAgB,CAAC,sBAAsB,CAAC,EAAE,EAAEI,aAAa,CAACP;IACrF;IAEAF,GAAG,sCAAsC;QACrC,IAAMC,kBAAkB,IAAIH;QAC5B,IAAMI,eAAe,IAAIN;QAEzBK,gBAAgBE,QAAQ,CAAC,uBAAuBD;QAChDE,OAAOH,gBAAgBI,gBAAgB,CAAC,sBAAsB,CAAC,EAAE,EAAEI,aAAa,CAACP;QAEjFD,gBAAgBS,UAAU,CAAC,uBAAuBR;QAElDE,OAAOH,gBAAgBI,gBAAgB,CAAC,sBAAsB,CAACE,MAAM,EAAEC,IAAI,CAAC;QAC5EJ,OAAOH,gBAAgBI,gBAAgB,CAAC,sBAAsB,EAAEC,WAAW;IAC/E;IAEAN,GAAG,wCAAwC;QACvC,IAAMC,kBAAkB,IAAIH;QAC5B,IAAMI,eAAe,IAAIN;QAEzBK,gBAAgBE,QAAQ,CAAC,uBAAuBD;QAChDE,OAAOH,gBAAgBI,gBAAgB,CAAC,sBAAsB,CAAC,EAAE,EAAEI,aAAa,CAACP;QAEjFD,gBAAgBU,aAAa;QAE7BP,OAAOH,gBAAgBI,gBAAgB,CAAC,sBAAsB,EAAEO,aAAa;IAGjF;IAEAZ,GAAG,0BAA0B;QACzB,IAAMC,kBAAkB,IAAIH;QAC5B,IAAMI,eAAe,IAAIN;QACzB,IAAMiB,kBAAkBC,KAAKC,KAAK,CAACb,cAAc;QAEjDD,gBAAgBE,QAAQ,CAAC,uBAAuBD;QAEhDE,OAAOH,gBAAgBI,gBAAgB,CAAC,sBAAsB,CAAC,EAAE,EAAEI,aAAa,CAACP;QAEjF,IAAMc,sBAAsB,IAAInB,oBAAoB;YAChDoB,IAAI;YACJC,MAAM;YACNC,aAAa;YACbC,OAAO;QACX;QAEAnB,gBAAgBoB,MAAM,CAACL;QAEvBZ,OAAOS,iBAAiBS,gBAAgB;IAE5C;AAEJ"}